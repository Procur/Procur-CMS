
<div id="companyBlogSearch">
  <div class="container">
    <div class="row">
      <div class="col-lg-9 col-md-9 col-sm-9 col-xs-12">
      <h1>Company Blog</h1><a href="/marketingblog">Company Blog Home</a>
      <hr>
      <% posts.forEach(function(post){ %>
        <% if(post.published == true){ %>
          <div><a href="/marketingblog/<%= post.id %>"><h3><%= post.title %></h3></a></div>
          <span><%= post.date %></span><span style="margin-left:30px"><%= post.category %></span><span style="margin-left:30px;color:red"><%= post.tagArray %></span>
          <div><p><%= post.content %></p></div>
          <% if(post.images!=null){ %><div><img src="<%= post.images %>"></div><% } %>
        <% } %>
      <% }); %>
      <!--Functionality for the page links-->
      <span class=pageNumbers>Navigate by page:</span>
      <% for (i=1;i<=Math.ceil(numTruePosts/3);i++) { %>
        <script>
          var a = document.createElement('a');
          a.href='';
          if (a.href.indexOf('page')==-1){
            a.href = a.href + '&page=<%=i%>';
          } else {
            var indexPage = a.href.indexOf('page');
            a.href = a.href.substr(0,indexPage+5) + '<%=i%>';
          }
          var page = $('<a />');
          page.attr('href',a.href);
          page.text('<%=i%>');
          $('.pageNumbers').append(page);
         </script>
      <% } %>

      <!--Next/Previous Links-->
      <a class="previous" href="#" onclick="previousPage(); return false;">PREVIOUS</a>
      <a class="next" href="#" onclick="nextPage(); return false;">NEXT</a>
      </div>

      <div class="col-lg-3 col-md-3 col-sm-3 col-xs-12">
        <h2>Search the Blog</h2>
        <form action="/marketingblog" class="searchForm" name="searchForm" method="post" enctype="multipart/form-data">
          <input type="text" class="searchInput" name="searchInput" placeholder="Search for Something..." size="30">
        </form>
        <h2>Blog Categories</h2>
        <a href="/marketingblogsearch?word=category1">Platform Announcements &amp; Updates</a>
        <a href="/marketingblogsearch?word=category2">Company News</a>
        <a href="/marketingblogsearch?word=category3">International Trade News &amp; Events</a>
        <a href="/marketingblogsearch?word=category4">Initiatives &amp; Company Philosophy</a>
        <a href="/marketingblogsearch?word=category5">Philanthropy</a>
        <h2>Other Resources</h2>
        <a href="/pressreleases">Press Releases</a>
        <a href="#">Media Coverage</a>
        <a href="#">Featured Suppliers</a>
        <h2>View by Date</h2>
        <h3>2015</h3>
        <a href="/marketingblogsearch?word=APRIL2015">April</a>
        <a href="/marketingblogsearch?word=MAY2015">May</a>
        <a href="/marketingblogsearch?word=JUNE2015">June</a>
        <a href="/marketingblogsearch?word=JULY2015">July</a>
        <a href="/marketingblogsearch?word=AUGUST2015">August</a>
        <a href="/marketingblogsearch?word=SEPTEMBER2015">September</a>
        <a href="/marketingblogsearch?word=OCTOBER2015">October</a>
        <a href="/marketingblogsearch?word=NOVEMBER2015">November</a>
        <a href="/marketingblogsearch?word=DECEMBER2015">December</a>
        <h3>2014</h3>
        <a href="/marketingblogsearch?word=JANUARY2014">January</a>
        <a href="/marketingblogsearch?word=FEBRUARY2014">February</a>
        <a href="/marketingblogsearch?word=MARCH2014">March</a>
        <a href="/marketingblogsearch?word=APRIL2014">April</a>
        <a href="/marketingblogsearch?word=MAY2014">May</a>
        <a href="/marketingblogsearch?word=JUNE2014">June</a>
        <a href="/marketingblogsearch?word=JULY2014">July</a>
        <a href="/marketingblogsearch?word=AUGUST2014">August</a>
        <a href="/marketingblogsearch?word=SEPTEMBER2014">September</a>
        <a href="/marketingblogsearch?word=OCTOBER2014">October</a>
        <a href="/marketingblogsearch?word=NOVEMBER2014">November</a>
        <a href="/marketingblogsearch?word=DECEMBER2014">December</a>

      </div>

    </div>
  </div>
</div>


<script>
//Next Page Functionality
function nextPageFire(){
  var a = document.createElement('a');
  a.href = '';
  if (a.href.indexOf('page')==-1){
    a.href = a.href + '&page=2';
    return a.href;
  }
  var pageNumber = myPageNumber();
  var indexPage = a.href.indexOf('page');
  a.href = a.href.substr(0,indexPage+5) + (parseInt(pageNumber)+1);
  return a.href;
}
//Previous Page Functionality
function previousPageFire(){
  var a = document.createElement('a');
  a.href='';
  var pageNumber = myPageNumber();
  var indexPage = a.href.indexOf('page');
  a.href = a.href.substr(0,indexPage+5) + (parseInt(pageNumber)-1);
  return a.href;
}

//Next page handler
function nextPage(){
  window.location = nextPageFire();
}

//Previous page handler
function previousPage(){
  window.location = previousPageFire();
}

//Are we on the first page?
function isFirstPage(){
  var a = document.createElement('a');
  a.href = '';
  if (a.href.indexOf('page')==-1 || myPageNumber()==1) {return true}
  return false;
}

//Are we on the last page?
function isLastPage(){
  var a = document.createElement('a');
  a.href = '';
  if (<%= numTruePosts %> <= 3) {return true};
  var pageNumber = a.search.replace( /^\D+/g, '');

  if((((pageNumber -1)*3)+<%= posts.length %>) == <%= numTruePosts %> || (pageNumber=="" && <%= numTruePosts %> <= 3)) return true;
  return false;
}

//if we are on the first page, hide the 'previous' link...
if (isFirstPage()==true){
  $(".previous").hide();
}

//if we are on the last page, hide the 'next' link...
if (isLastPage()==true){
  $(".next").hide();
}

//parse the url and return the page number
function myPageNumber(){
  var queryString = window.location.search;
  var pageIndex = queryString.indexOf('page');
  var lengthQueryString = queryString.length;
  var pageNumber = queryString.substr(pageIndex+5,lengthQueryString-1);
  return pageNumber;
}
</script>
